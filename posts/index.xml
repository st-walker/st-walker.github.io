<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Posts on Coherent Synchrotron Radiation</title>
        <link>https://st-walker.github.io/posts/</link>
        <description>Recent content in Posts on Coherent Synchrotron Radiation</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-GB</language>
        <copyright>&lt;a href=&#34;https://creativecommons.org/licenses/by-nc/4.0/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CC BY-NC 4.0&lt;/a&gt;</copyright>
        <lastBuildDate>Tue, 21 Sep 2021 10:33:58 +0200</lastBuildDate>
        <atom:link href="https://st-walker.github.io/posts/index.xml" rel="self" type="application/rss+xml" />
        
        <item>
            <title>Gpt Csrtrack Ocelot</title>
            <link>https://st-walker.github.io/posts/benchmarks/gpt-csrtrack-ocelot/</link>
            <pubDate>Tue, 21 Sep 2021 10:33:58 +0200</pubDate>
            
            <guid>https://st-walker.github.io/posts/benchmarks/gpt-csrtrack-ocelot/</guid>
            <description>Overview Here I am going to compare CSRTRack, OCELOT and GPT with application to CSR simulations in bunch compressors.
The Zeuthen Benchmark Chicane The Zeuthen chicane is the standard chicane used in the literature when evaluting different CSR codes, and is accordingly used here. The chicane and beam parameters parameters are below. The chicane parameters are a subset of the ones on the website
The beam parmaters (with compression) are the same as the ones outlined on the website except with a reduced energy from 5GeV to 0.</description>
            <content type="html"><![CDATA[<h1 id="overview">Overview</h1>
<p>Here I am going to compare CSRTRack, OCELOT and GPT with application to CSR simulations
in bunch compressors.</p>
<h1 id="the-zeuthen-benchmark-chicane">The Zeuthen Benchmark Chicane</h1>
<p>The <a href="https://www.desy.de/csr/">Zeuthen chicane</a> is the standard chicane used in the
literature when evaluting different CSR codes, and is accordingly used here.  The
chicane and beam parameters parameters are below.  The chicane parameters are a subset
of the ones on the website</p>
<p>The beam parmaters (with compression) are the same as the ones outlined on the website
except with a reduced energy from 5GeV to 0.5GeV, motivated by a desire to possibly
demonstrate any non-radiative CSR effects.  Furthermore, the simulation excludes any
longitudinal charge density modulation, as well as the uncorrelated energy spread
being set to 10keV.  The phase space for this input distribution is shown as well.</p>
<table>
<tr><th>Zeuthen chicane parameters </th><th>Zeuthen beam parameters</th></tr>
<tr><td>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Value</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>Projected drift length 1/2, 3/4</td>
<td>5.0</td>
<td>m</td>
</tr>
<tr>
<td>Drift length 2/3</td>
<td>1.0</td>
<td>m</td>
</tr>
<tr>
<td>Dipole length</td>
<td>0.5</td>
<td>m</td>
</tr>
<tr>
<td>Post chicane drift</td>
<td>2.0</td>
<td>m</td>
</tr>
<tr>
<td>Total projected length</td>
<td>13.0</td>
<td>m</td>
</tr>
<tr>
<td>R<sub>56</sub></td>
<td>-25</td>
<td>mm</td>
</tr>
<tr>
<td>T<sub>566</sub></td>
<td>+37.5</td>
<td>mm</td>
</tr>
<tr>
<td>Bending angle</td>
<td>2.77</td>
<td>°</td>
</tr>
<tr>
<td>Bending radius</td>
<td>10.35</td>
<td>m</td>
</tr>
<tr>
<td>Vertical halfgap of dipoles</td>
<td>5</td>
<td>mm</td>
</tr>
</tbody>
</table>
</td><td>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Value</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>Beam energy</td>
<td>0.5</td>
<td>GeV</td>
</tr>
<tr>
<td>Linear energy-z correlation</td>
<td>36</td>
<td>m<sup>-1</sup></td>
</tr>
<tr>
<td>Normalised emittance</td>
<td>1.0</td>
<td>mm·mrad</td>
</tr>
<tr>
<td>Bunch length</td>
<td>200</td>
<td>μm</td>
</tr>
<tr>
<td>Peak current</td>
<td>0.6</td>
<td>kA</td>
</tr>
<tr>
<td>Bunch charge</td>
<td>1</td>
<td>nC</td>
</tr>
<tr>
<td>Uncorrelated energy spread</td>
<td>10</td>
<td>keV</td>
</tr>
<tr>
<td>β<sub>x,y</sub></td>
<td>40, 13</td>
<td>m</td>
</tr>
<tr>
<td>α<sub>x,y</sub></td>
<td>2.6, 1.0</td>
<td>m</td>
</tr>
</tbody>
</table>
</td></tr> </table>
<p><img src="/gpt/zeuthen-primary.pdf" alt="input-distro" title="Input beam distribution for nominal Zeuthen"></p>
<p>The increase in the slice energy spread at the tails of the distribution is wsimply an
artefact of the algorithm used to calculate it.  The algorithm proceeds by accumulating
N macroparticles per slice.  At the tails the number of macroparticles is small compared
to N, so the slice is relatively long in z, resulting in the slice energy spread being
dominated by the linear chirp, and rises accordingly..  This is a common feature in
plots that follow. Lastly the distributions are started 10cm upstream of the first
dipole entrance to ensure no spurious dispersion from the bunch overlapping with the fringe
fields.</p>
<h1 id="optical-tracking-without-collective-effects">Optical tracking without collective effects</h1>
<p>This is necessary as a sanity check before further more time-consuming simulations.
CSRTrack, OCELOT and GPT for the Zeuthen benchmark are all run without any collective
effects.</p>
<h1 id="input-distributions">Input distributions</h1>
<p>The distribution for the Zeuthen benchmark is shown bel</p>
<h2 id="csr-use-case-1">CSR use case 1</h2>
<h2 id="heading"></h2>
]]></content>
        </item>
        
        <item>
            <title>The eSASE chicane and CSR</title>
            <link>https://st-walker.github.io/posts/benchmarks/esase/</link>
            <pubDate>Thu, 16 Sep 2021 13:51:55 +0200</pubDate>
            
            <guid>https://st-walker.github.io/posts/benchmarks/esase/</guid>
            <description>Overview A set of benchmarks for the study of the proposed eSASE chicane in the EUXFEL. It is important to understand how the beam may be degrade due CSR in the chicane, and whether or not the optical configuration by introducing β-function waist in the fourth dipole. If CSR degradation in the chicane even with the existing FODO optics is tolerable then all is well.
The parameters of the chicane and the input beam distribution are as follows:</description>
            <content type="html"><![CDATA[<h1 id="overview">Overview</h1>
<p>A set of benchmarks for the study of the proposed eSASE chicane in the EUXFEL.  It is
important to understand how the beam may be degrade due CSR in the chicane, and whether
or not the optical configuration by introducing β-function waist in the fourth
dipole. If CSR degradation in the chicane even with the existing FODO optics is
tolerable then all is well.</p>
<p>The parameters of the chicane and the input beam distribution are as follows:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Value</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td>Projected drift length 1/2, 3/4</td>
<td>1</td>
<td>m</td>
</tr>
<tr>
<td>Drift length 2/3</td>
<td>0.4</td>
<td>m</td>
</tr>
<tr>
<td>Dipole length</td>
<td>0.6</td>
<td>m</td>
</tr>
<tr>
<td>R<sub>56</sub></td>
<td>-190.5</td>
<td>µm</td>
</tr>
<tr>
<td>Bending angle</td>
<td>0.47</td>
<td>°</td>
</tr>
<tr>
<td>Bending radius</td>
<td>72.72</td>
<td>m</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Beam energy</td>
<td>14</td>
<td>GeV</td>
</tr>
<tr>
<td>Linear energy-z correlation (central peak)</td>
<td>5455</td>
<td>m<sup>-1</sup></td>
</tr>
<tr>
<td>Average β<sub>x,y</sub></td>
<td>32</td>
<td>m</td>
</tr>
<tr>
<td>Initial normalised emittance</td>
<td>0.6</td>
<td>µm</td>
</tr>
<tr>
<td>Initial peak current</td>
<td>5</td>
<td>kA</td>
</tr>
<tr>
<td>Bunch charge</td>
<td>250</td>
<td>pC</td>
</tr>
<tr>
<td>Uncorrelated energy spread</td>
<td>2.5</td>
<td>MeV</td>
</tr>
</tbody>
</table>
<h2 id="initial-distribution">Initial distribution</h2>
<p>As stated above the intention is to study two sets of optics, standard FODO optics and
optimised optics.  The FODO optics are shown below.  All simulations below are run using
these exact optics.  I have yet to do a more optimal one.</p>
<p><img src="/esase/optics-sub-optimal.pdf" alt="fodo-optics" title="FODO optics in the eSASE chicane"></p>
<p>The projected slice lengths for this configuration are below, and it can be seen that
the projected slice lengths are small compared with the bunch length above (~20µm).  The
projected lengths were derived using the equation stated in <a href="https://www.desy.de/fel-beam/data/talks/papers/impact_of_optics_2005.pdf">this
paper</a>.  The
waist s<sub>w</sub> is equal to 0 in this configuration, leading to a relation that is
dominated by the R<sub>51</sub> due to the small angle (R<sub>56</sub>), which is
equivalent in magnitude on both sides of the chicane.  The acumulated R<sub>51</sub> and
R<sub>52</sub> through the chicane are shown.  However the lengths are comparable in
length to that of the final eSASE spike (100nm).</p>
<p><img src="/esase/sigma_proj-r51-r52.pdf" alt="projected-slice-length"></p>
<p>The input distribution (without energy modulation) is as follows:</p>
<p><img src="/esase/esase-primary.pdf" alt="esase-primary" title="Input distribution without chirp"></p>
<p>The energy modulation with the longitudinal beam profile
overlaid is shown below.  The width of the central peak&rsquo;s linear part is about 0.2µm,
giving a linear chirp of about 5455m<sup>-1</sup>.  For maximal compression, this corresponds to
an R<sub>56</sub> of -1/5455m<sup>-1</sup> = -190.5µm.</p>
<p><img src="/esase/esase-modulation-with-beam.png" alt="esase-emod" title="Energy modulation"></p>
<h1 id="tracking-without-any-csr">Tracking without any CSR</h1>
<p>First it is useful to examine the compression without any collective effects to ensure
that the beam and chicane are implemented correctly.  Shown below are the beam
distributions before and after the chicane.  The chicane and the chirp bring the peak
current to nearly 20kA, as expected.</p>
<h2 id="ocelot-tracking-without-csr">OCELOT tracking without CSR</h2>
<p><img src="/esase/ocelot_compared_beams_no_csr.png" alt="esase-no-csr-ocelot" title="OCELOT before and after chicane, no CSR"></p>
<h1 id="tracking-with-csr-but-without-energy-modulation">Tracking with CSR but without energy modulation</h1>
<p>To simply study the impact of CSR on a bunch of this length in the given chicane, I
simulated without any compression.  There is a slight deformation in the bunch slice
positions shown in the top right, but no growth in the slice or projected emittances at
all.</p>
<h2 id="gpt-with-csr-no-energy-modulation">GPT with CSR, no energy modulation</h2>
<p><img src="/esase/gpt-output-csr-without-chirp.pdf" alt="esase-no-csr-gpt"></p>
<h2 id="csrtrack-with-csr-no-energy-modulation">CSRTrack with CSR, no energy modulation</h2>
<p><img src="/esase/csrtrack-output-csr-without-chirp.pdf" alt="esase-no-csr-gpt"></p>
<h1 id="tracking-with-csr">Tracking with CSR</h1>
<p>As the chicane and input beam distributions seem to be working correctly, now to include
CSR effects.</p>
<h3 id="tuning-simulation-parameters">Tuning simulation parameters</h3>
<p>In GPT I set the <code>accuracy</code> (number of decimal places in γβ) to 6, which is
the same as used for the Zeuthen benchmark.</p>
<p>In OCELOT there are a number that must be adjusted to ensure physical results.  The two
most pertinent are <code>unit_step</code> of the <code>Navigator</code> class and <code>sigma_min</code> of the <code>CSR</code>
class.  As I understand it, <code>unit_step</code> must be set sufficiently small to ensure that
the Navigator doesn&rsquo;t take very large steps (otherwise the backtracking employed when
calculating the CSR wake will be wrong, as it uses the rigid beam approximation I
think), and <code>sigma_min</code> must sufficiently small to not smooth out any small details (but
not so small that one will see artificial microbunching).  The central spike goes down
to about 100nm in length, so I chose a value of <code>sigma_min</code> of 10nm (one tenth the beam
size or the length of some feature of interest is the rule of thumb I used).  The
<code>unit_step</code> I set to 1 cm on the basis of convergence studies I performed for the
Zeuthen benchmark, but obviously this is a different chicane so this could indeed be
wrong here.</p>
<p>For CSRTrack (1D) I used a <code>sigma_long</code> of 10nm, using the same reasoning
as for <code>sigma_min</code> in OCELOT.  The rest of the CSRTrack tracking configuration:</p>
<pre tabindex="0"><code>  track_step{precondition=yes
             iterative=2
             error_per_ct=0.001
             error_weight_momentum=0.0

             ct_step_min=0.02
             ct_step_max=0.10
             ct_step_first=0.10
             increase_factor=1.5
             arc_factor=0.3
             duty_steps=yes
            }
</code></pre><h2 id="ocelot-csr">OCELOT CSR</h2>
<p>No impact on the slice or projected emittances can be seen.  The different post-chicane peak current
shown here to OCELOT tracking without CSR is generally because the peak current is
sensitive to the initial seed for some reason.</p>
<p><img src="/esase/ocelot-before-after-with-csr.png" alt="ocelot-esase-with-csr" title="OCELOT before and after CSR"></p>
<h2 id="gpt-csr">GPT CSR</h2>
<p><img src="/esase/gpt-output.pdf" alt="gpt-esase-with-csr" title="GPT before and after CSR"></p>
<h2 id="csrtrack-csr">CSRTrack CSR</h2>
<p><img src="/esase/CSRtrack-output.pdf" alt="csrtrack-esase-with-csr" title="CSRTrack befor and after CSR"></p>
<h1 id="why-csr-doesnt-matter-for-esase">Why CSR doesn&rsquo;t matter for eSASE</h1>
<p>The angle for the eSASE chicane is very small, much smaller than in the other
compressing chicanes at the EUXFEL.  The investivated R<sub>56</sub> values of -200µm
and -600µm correspond to dipole angles of 8.84mrad and 14.6mrad, compared with
~(40-50)mrad for BCs 1 and 2.  The figure shows the relationship between the final
projected emittance and the dipole angle.  Clearly in the range of angles for eSASE,
there is no impact, which is not the case for a reasonable BC1 angle.</p>
<p><img src="/esase/angle-vs-projected-emittance.png" alt="ocelot-esase-angle-scan"></p>
<p>However this does not explain why CSR in the chicane does not impact the emittance.
Given the very strong current spikes after the eSASE chicane, one would typically expect
a strong CSR wake due to the CSR wake integrand&rsquo;s proportionality to the longitudinal
charge density gradient.  Sufficiently small angles do not allow for radiation emitted
by the tail to catch up with the head of the bunch.  The overtaking angles for a range
of bunch lengths in a 0.6m dipole (i.e. the one used in eSASE) is shown below.  It is
clear then at the the 6.3µm bunch length (5kA) that any radiation emitted by the tail
will not catch up with the head in the dipole.</p>
<p><img src="/esase/overtaking-length.png" alt="overtaking-length"></p>
<p>This explains why eSASE is not impacted by CSR.  The angle is too small and the dipole
is too short for the radiation to overtake the bunch.  It is possible that transient
effects due to the velocity term will impact the bunch, but these are also suppressed
due to the high energy and low bending radius.  Finally</p>
<p><img src="/esase/esase-200-um-max-compression.gif" alt="ocelot-esase-max-compression-animation"></p>
<p>In contrast, for 0.05 radians (comparable to BC1/2), but also featuring overcompression:</p>
<p><img src="/esase/bigger-angle-compression.gif" alt="ocelot-esase-max-compression-animation"></p>
<p>Also plot the dispersion.</p>
<p>! # Conclusion</p>
<p>! Contrary to my own expectations, CSR seems to have little impact on the projected or
! slice emittances.  This is most likely due to the minimal longitudinal mixing,
! ultimately stemming from the small bending angle and smaller geometric emittance.</p>
]]></content>
        </item>
        
        <item>
            <title>Zeuthen Benchmark</title>
            <link>https://st-walker.github.io/posts/benchmarks/zeuthen-benchmark/</link>
            <pubDate>Fri, 03 Sep 2021 16:25:21 +0200</pubDate>
            
            <guid>https://st-walker.github.io/posts/benchmarks/zeuthen-benchmark/</guid>
            <description>True Zeuthen benchmark: WITH / WITHOUT SC.
Relaxed Zeuthen bencharmk (200pC everything else the same)
quasi-bc1 example (1.4GeV to 2.4kA)</description>
            <content type="html"><![CDATA[<p>True Zeuthen benchmark: WITH / WITHOUT SC.</p>
<p>Relaxed Zeuthen bencharmk  (200pC everything else the same)</p>
<p>quasi-bc1 example (1.4GeV to 2.4kA)</p>
]]></content>
        </item>
        
    </channel>
</rss>
